
<div class="banner-index" style="background-image: linear-gradient(-225deg, rgba(0,101,168,0.6) 0%, rgba(0,36,61,0.6) 50%), url('<%= cl_image_path "dogbanner_sc5jqh"%>');">
  <div class="banner-content">
    <h1>Find a dog in your area</h1>
    <input type="text" name="q" id="q" class="form-control"/>

  </div>
</div>



<div class="container-index">
  <div class="row">
    <div class="col-xs-12 col-sm-2" id="facets">
      <div id="breed"></div>
      <div id="size"></div>
    </div>

    <div class="col-xs-12 col-sm-10" id="hits">
      <div class="row">
        <%  @dogs.each do |dog| %>

        <div class="col-xs-12 col-md-6 col-lg-4">
          <!-- insert <div class="card"> -->

          <div class="card" style="background-image: linear-gradient(rgba(100,100,100,0.4), rgba(150,150,150,0.2)), url('<%= cl_image_path dog.photo_url, crop: :fill %>');">
            <div class="card-category"><h2><%= link_to dog.name, dog_path(dog) %></h2></div>
            <h4 class="breed"><%= dog.breed %></h4>
            <div class="card-description text-center">
              <p><i class="fa fa-map-marker" aria-hidden="true"></i>
                <%= dog.location %></p>
                <div class="banner-card">.</div>

              </div>
              <img class="card-user avatar" src="http://www.fillmurray.com/g/60/60">
            </div>

          </div>
          <% end %>
        </div>
      </div>
    </div>





<% content_for(:after_js) do %>
<script src="//cdn.jsdelivr.net/instantsearch.js/1/instantsearch.min.js"></script>
<script type="text/javascript">
  $(document).ready(function() {

    var hitTemplate=' <div class="col-xs-12 col-md-6 col-lg-4"><div class="card" style="background-image: linear-gradient(rgba(100,100,100,0.4), rgba(150,150,150,0.2)), url(\'{{{photo}}}\');">'+
    '<div class="card-category"><h2><a href="{{{url}}}">{{{_highlightResult.name.value}}}</a></h2></div>'+
    '<h4 class="breed">{{{_highlightResult.breed.value}}}</h4>'+
    '<div class="card-description text-center">'+
    '<p><i class="fa fa-map-marker" aria-hidden="true"></i>'+
    '{{{_highlightResult.location.value}}}</p>'+
    '<div class="banner-card">.</div>'+
    '</div>'+
    '<img class="card-user avatar" src="http://www.fillmurray.com/g/60/60">'+
    '</div></div>';
    var search = instantsearch({
      appId: '<%= ENV['ALGOLIASEARCH_APPLICATION_ID'] %>',
      apiKey: '<%= ENV['ALGOLIASEARCH_API_KEY_SEARCH'] %>',
      indexName: '<%= Dog.index_name %>',
      urlSync: true
    });

    search.addWidget(
      instantsearch.widgets.searchBox({
        container: '#q',
        placeholder: 'Please search for name or breed',
        autofocus: false,
        poweredBy: true
      })
      );
    search.addWidget(
      instantsearch.widgets.infiniteHits({
        container: '#hits',
        templates: {
          empty: 'No dogs found',
          item: hitTemplate
        },
        hitsPerPage: 9
      })
      );
    search.addWidget(
      instantsearch.widgets.refinementList({
        container: '#breed',
        attributeName: 'breed',
        limit: 10,
        templates: {
          header: 'Breed'
        },
        cssClasses: {
          root: 'list-group',
          item: 'list-group-item',
          count: 'badge pull-right'
        }
      })
      );
    search.addWidget(
      instantsearch.widgets.refinementList({
        container: '#size',
        attributeName: 'size',
        templates: {
          header: 'Size'
        },
        cssClasses: {
          root: 'list-group',
          item: 'list-group-item',
          count: 'badge pull-right'
        }
      })
      );
    search.start();
  });
</script>

<% end %>


